<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>History Quiz — All Continents</title>
  <style>
    *{box-sizing:border-box;font-family:'Georgia','Segoe UI',Arial,serif}
    body{background:linear-gradient(135deg, #d4a574 0%, #c09060 100%);color:#333;margin:0;padding:0;min-height:100vh}
    .container{max-width:900px;margin:0 auto;padding:0}
    header{text-align:center;padding:40px 20px 20px;background:transparent}
    header h1{margin:0;font-size:3.5em;color:#8b6f47;text-shadow:2px 2px 4px rgba(0,0,0,0.2);font-weight:700;letter-spacing:2px}
    header p{display:none}
    .lang-selector{position:absolute;top:20px;right:20px;display:flex;gap:8px}
    .lang-btn{padding:8px 16px;border:none;background:#8b6f47;color:#fff;border-radius:6px;cursor:pointer;font-weight:600}
    .lang-btn.active{background:#c9a961;color:#333}
    .lang-btn:hover{opacity:0.8}
    .landing{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:80vh;padding:40px 20px;text-align:center}
    .menu-title{font-size:2em;color:#8b6f47;margin-bottom:24px;text-transform:uppercase;letter-spacing:2px;text-align:center}
    .scroll-banner{background:#d4c4a8;padding:40px 60px;border-radius:12px;box-shadow:0 8px 16px rgba(0,0,0,0.3);position:relative;margin:20px 0;transform:rotate(-1deg)}
    .scroll-banner::before{content:'';position:absolute;top:-10px;left:10px;width:20px;height:20px;background:#d4c4a8;border-radius:50%}
    .scroll-banner::after{content:'';position:absolute;bottom:-10px;right:10px;width:20px;height:20px;background:#d4c4a8;border-radius:50%}
    .scroll-text{font-size:2.2em;color:#8b6f47;font-weight:700;letter-spacing:3px;margin:0;text-transform:uppercase}
    #startBtn{background:linear-gradient(135deg, #c9a961 0%, #a89860 100%);color:#fff;border:none;padding:20px 60px;border-radius:8px;cursor:pointer;font-size:1.6em;font-weight:700;text-transform:uppercase;letter-spacing:2px;box-shadow:0 6px 12px rgba(0,0,0,0.3);transition:transform 0.2s,box-shadow 0.2s;margin-top:30px}
    #startBtn:hover{transform:scale(1.05);box-shadow:0 8px 16px rgba(0,0,0,0.4)}
    #startBtn:active{transform:scale(0.98)}
    .controls{background:#fff;border-radius:8px;padding:32px;margin:40px auto;max-width:700px;box-shadow:0 4px 12px rgba(0,0,0,0.15)}
    #startQuizBtn{background:linear-gradient(135deg, #c9a961 0%, #a89860 100%);padding:12px 40px;font-size:1.1em;font-weight:700;text-transform:uppercase;margin-top:20px;display:block;margin-left:auto;margin-right:auto;border:none;border-radius:8px;cursor:pointer;color:#fff}
    .control-row{margin:20px 0;display:flex;flex-direction:column;align-items:flex-start;gap:12px}
    .control-row label{font-weight:700;color:#8b6f47;font-size:1.1em}
    .checkboxes{display:flex;flex-wrap:wrap;gap:12px}
    .checkboxes label{margin-right:0;font-weight:normal;color:#333}
    .radio{display:flex;gap:16px;flex-wrap:wrap}
    .radio label{margin-right:0;font-weight:normal;color:#333}
    #numQuestions{padding:8px 12px;border:1px solid #ddd;border-radius:6px;font-size:1em}
    .back-btn{background:#8b6f47;color:#fff;border:none;padding:10px 20px;border-radius:6px;cursor:pointer;font-weight:600;margin-bottom:16px}
    .back-btn:hover{background:#6f5935}
    .hidden{display:none}
    .quiz,.results{background:#fff;border-radius:8px;padding:16px;margin-top:16px;box-shadow:0 2px 8px rgba(14,14,14,0.06);margin:40px auto;max-width:900px}
    .card{padding:12px;border:1px solid #eee;border-radius:6px}
    .question{font-size:1.1rem;margin-bottom:12px}
    .choices{display:flex;flex-direction:column;gap:8px}
    .choice{padding:10px;border-radius:6px;border:1px solid #ddd;cursor:pointer;background:#fafafa}
    .choice.correct{background:#d1fae5;border-color:#10b981}
    .choice.wrong{background:#fee2e2;border-color:#ef4444}
    .results ol{padding-left:1.1rem}
    .results li{margin-bottom:10px}
    .answer-user.correct{color:#065f46;font-weight:700}
    .answer-user.wrong{color:#991b1b;font-weight:700}
    .answer-correct{color:#047857;font-weight:700}
    .nav{margin-top:12px}
    #progress{font-size:.95rem;margin-bottom:8px;color:#374151}
    #timer{font-size:1.2rem;font-weight:bold;margin-bottom:12px;padding:8px 12px;border-radius:6px;display:inline-block;background:#f0f0f0}
    #timer.warning{background:#ffd700;color:#d97706}
    #timer.danger{background:#ef4444;color:#fff}
    footer{margin-top:18px;color:#6b7280;text-align:center;padding:20px}
    button[disabled]{opacity:.6;cursor:not-allowed}
  </style>
</head>
<body>
  <div class="lang-selector">
    <button class="lang-btn active" data-lang="en">English</button>
    <button class="lang-btn" data-lang="th">ไทย</button>
  </div>

  <div class="container">
    <header>
      <h1>HISTORY QUIZ</h1>
    </header>

    <section class="landing" id="landing">
      <div class="scroll-banner">
        <p class="scroll-text" data-i18n="testKnowledge">Test Your Knowledge</p>
      </div>
      <button id="startBtn" data-i18n="play">Play</button>
    </section>

    <section class="controls hidden" id="controls">
      <h2 class="menu-title" data-i18n="selectQuiz">Select Your Quiz</h2>
      <button class="back-btn" id="backBtn" data-i18n="back">← Back</button>
      <div class="control-row">
        <label data-i18n="continents"><strong>Continents:</strong></label>
        <div class="checkboxes">
          <label><input type="checkbox" value="Africa" checked> <span data-i18n="africa">Africa</span></label>
          <label><input type="checkbox" value="Asia" checked> <span data-i18n="asia">Asia</span></label>
          <label><input type="checkbox" value="Europe" checked> <span data-i18n="europe">Europe</span></label>
          <label><input type="checkbox" value="North America" checked> <span data-i18n="northAmerica">North America</span></label>
          <label><input type="checkbox" value="South America" checked> <span data-i18n="southAmerica">South America</span></label>
          <label><input type="checkbox" value="Oceania" checked> <span data-i18n="oceania">Oceania</span></label>
        </div>
      </div>

      <div class="control-row">
        <label data-i18n="difficulty"><strong>Difficulty:</strong></label>
        <div class="radio">
          <label><input type="radio" name="difficulty" value="easy" checked> <span data-i18n="easy">Easy</span></label>
          <label><input type="radio" name="difficulty" value="medium"> <span data-i18n="medium">Medium</span></label>
          <label><input type="radio" name="difficulty" value="hard"> <span data-i18n="hard">Hard</span></label>
        </div>
      </div>

      <div class="control-row">
        <label data-i18n="numQuestions"><strong>Number of questions:</strong></label>
        <select id="numQuestions">
          <option value="5">5</option>
          <option value="10" selected>10</option>
          <option value="15">15</option>
          <option value="20">20</option>
        </select>
      </div>

      <div class="control-row">
        <button id="startQuizBtn" data-i18n="startQuiz">Start Quiz</button>
      </div>
    </section>

    <section class="quiz hidden" id="quiz">
      <div id="progress"><span data-i18n="question">Question</span> <span id="current">0</span> / <span id="total">0</span> | <span id="timer">--</span></div>
      <div id="questionBox" class="card">
        <div id="questionText" class="question"></div>
        <div id="choices" class="choices"></div>
      </div>
      <div class="nav">
        <button id="nextBtn" disabled data-i18n="next">Next</button>
      </div>
    </section>

    <section class="results hidden" id="results">
      <h2 data-i18n="results">Results</h2>
      <div id="summary"></div>
      <button id="restartBtn" data-i18n="playAgain">Play Again</button>
    </section>

    <footer>
    </footer>
  </div>

  <script>
// Translation dictionary
const translations = {
  en: {
    testKnowledge: 'Test Your Knowledge',
    play: 'Play',
    selectQuiz: 'Select Your Quiz',
    back: '← Back',
    continents: 'Continents:',
    africa: 'Africa',
    asia: 'Asia',
    europe: 'Europe',
    northAmerica: 'North America',
    southAmerica: 'South America',
    oceania: 'Oceania',
    difficulty: 'Difficulty:',
    easy: 'Easy',
    medium: 'Medium',
    hard: 'Hard',
    numQuestions: 'Number of questions:',
    startQuiz: 'Start Quiz',
    question: 'Question',
    next: 'Next',
    results: 'Results',
    playAgain: 'Play Again',
    score: 'Score:',
    byContinent: 'By Continent',
    answers: 'Answers',
    correct: 'Correct',
    wrong: 'Wrong',
    yourAnswer: 'Your answer:',
    correctAnswer: 'Correct:',
    studyRecommendations: 'Study Recommendations',
    noWeakTopics: 'Great job — no specific weak topics detected. Review broadly to strengthen knowledge.',
    tip: 'Tip: For each item above, read a short overview (Wikipedia or textbook), then revisit related questions.',
    noQuestionsMatch: 'No questions match your selection. Try different filters.',
    onlyMatched: 'Only {count} {difficulty} question(s) matched. Added {added} question(s) from other difficulties to reach {total}.',
    proceedingWith: 'Only {count} question(s) matched your filters; proceeding with {count}.'
  },
  th: {
    testKnowledge: 'ทดสอบความรู้ของคุณ',
    play: 'เล่น',
    selectQuiz: 'เลือกแบบทดสอบของคุณ',
    back: '← ย้อนกลับ',
    continents: 'ทวีป:',
    africa: 'แอฟริกา',
    asia: 'เอเชีย',
    europe: 'ยุโรป',
    northAmerica: 'อเมริกาเหนือ',
    southAmerica: 'อเมริกาใต้',
    oceania: 'โอเชียเนีย',
    difficulty: 'ระดับความยาก:',
    easy: 'ง่าย',
    medium: 'ปานกลาง',
    hard: 'ยาก',
    numQuestions: 'จำนวนคำถาม:',
    startQuiz: 'เริ่มแบบทดสอบ',
    question: 'คำถาม',
    next: 'ถัดไป',
    results: 'ผลลัพธ์',
    playAgain: 'เล่นอีกครั้ง',
    score: 'คะแนน:',
    byContinent: 'จำแนกตามทวีป',
    answers: 'คำตอบ',
    correct: 'ถูกต้อง',
    wrong: 'ผิด',
    yourAnswer: 'คำตอบของคุณ:',
    correctAnswer: 'คำตอบที่ถูก:',
    studyRecommendations: 'คำแนะนำการศึกษา',
    noWeakTopics: 'ทำได้ดี — ไม่พบหัวข้อที่อ่อนแอเฉพาะ โปรดทบทวนอย่างกว้างขวางเพื่อเสริมความรู้',
    tip: 'เคล็ดลับ: สำหรับแต่ละรายการข้างต้น โปรดอ่านภาพรวมสั้นๆ (Wikipedia หรือตำราเรียน) จากนั้นทบทวนคำถามที่เกี่ยวข้อง',
    noQuestionsMatch: 'ไม่มีคำถามที่ตรงกับการเลือกของคุณ ลองเปลี่ยนตัวกรอง',
    onlyMatched: 'มีเพียง {count} คำถาม {difficulty} เท่านั้น เพิ่ม {added} คำถามจากระดับความยากอื่นๆ เพื่อให้ถึง {total}',
    proceedingWith: 'มีเพียง {count} คำถามที่ตรงกับตัวกรองของคุณเท่านั้น ดำเนินการต่อด้วย {count}'
  }
}

// Full quiz data with Thai translations
const QUIZ_DATA = [
  {"continent":"Africa","region":"North Africa","difficulty":"easy","question":"Which ancient civilization built the pyramids at Giza?","question_th":"อารยธรรมโบราณใดที่สร้างปิรามิดที่กีซา?","choices":["Ancient Egypt","Carthage","Nubia","Axum"],"choices_th":["อียิปต์โบราณ","คาร์เธจ","นูเบีย","อักซูม"],"answer":"Ancient Egypt","answer_th":"อียิปต์โบราณ"},
  {"continent":"Africa","region":"West Africa","difficulty":"easy","question":"Which empire was famous for its wealth in gold and was located in present-day Mali?","question_th":"จักรวรรดิใดมีชื่อเสียงในด้านความร่ำรวยของทองคำและตั้งอยู่ในมาลีปัจจุบัน?","choices":["Mali Empire","Songhai Empire","Ghana Empire","Meroe Kingdom"],"choices_th":["จักรวรรดิมาลี","จักรวรรดิสงไห","จักรวรรดิกานา","อาณาจักรเมโรเอ"],"answer":"Mali Empire","answer_th":"จักรวรรดิมาลี"},
  {"continent":"Africa","region":"East Africa","difficulty":"medium","question":"Which ancient trading city on the Swahili coast became wealthy through trade with Arabia and India?","question_th":"เมืองค้าขายโบราณใดบนชายฝั่งสวาฮิลีกลายเป็นอุดมสมบูรณ์จากการค้าขายกับอาหรับและอินเดีย?","choices":["Kilwa","Cairo","Mompox","Zanzibar"],"choices_th":["กิลวา","ไคโร","มอมพอกส์","สันซิบาร์"],"answer":"Kilwa","answer_th":"กิลวา"},
  {"continent":"Africa","region":"Southern Africa","difficulty":"medium","question":"Who led the Zulu people to create a powerful kingdom in the early 19th century?","question_th":"ใครนำชาวซูลูสร้างอาณาจักรที่มีประสิทธิพลในช่วงต้นศตวรรษที่ 19?","choices":["Shaka","Mansa Musa","Nelson","Lalibela"],"choices_th":["ชาก้า","มันซา มูซา","เนลสัน","ลาลิเบลา"],"answer":"Shaka","answer_th":"ชาก้า"},
  {"continent":"Africa","region":"North Africa","difficulty":"hard","question":"Which Carthaginian general famously crossed the Alps to invade Italy during the Second Punic War?","question_th":"将軍คาร์เธจีนากลไกครั้งใดข้ามแอลป์ไปยุโรปเพื่อรุกรานอิตาลีในสงครามปูนิกครั้งที่สอง?","choices":["Hannibal","Scipio","Hasdrubal","Mago"],"choices_th":["แฮนนิบาล","ซิปิโอ","ฮัสดรูบาล","มาโก"],"answer":"Hannibal","answer_th":"แฮนนิบาล"},
  {"continent":"Africa","region":"East Africa","difficulty":"hard","question":"Which medieval Ethiopian king is traditionally associated with the rock-hewn churches of Lalibela?","question_th":"กษัตริย์เอธิโอเปียยุคกลางใดที่เกี่ยวข้องกับโบสถ์ที่สลักในหินของลาลิเบลา?","choices":["Gebre Mesqel Lalibela","Haile Selassie","Ezana","Menelik II"],"choices_th":["เกเบริ เมสเกล ลาลิเบลา","ไฮเล เซลาสซี","เอซานา","มเนลิก ที่สอง"],"answer":"Gebre Mesqel Lalibela","answer_th":"เกเบริ เมสเกล ลาลิเบลา"},
  {"continent":"Asia","region":"East Asia","difficulty":"easy","question":"Which dynasty built the majority of the Great Wall of China that we see today?","question_th":"ราชวงศ์ใดที่สร้างกำแพงป้องกันจีนส่วนใหญ่ที่เห็นในปัจจุบัน?","choices":["Ming","Han","Tang","Qin"],"choices_th":["หมิง","หาน","唐","ฉิน"],"answer":"Ming","answer_th":"หมิง"},
  {"continent":"Asia","region":"South Asia","difficulty":"easy","question":"Which empire is known for spreading Buddhism across much of South Asia and beyond under Emperor Ashoka?","question_th":"จักรวรรดิใดมีชื่อเสียงในการเผยแพร่พุทธศาสนาในเอเชียใต้และพื้นที่อื่นภายใต้จักรพรรดิอโศกา?","choices":["Maurya Empire","Gupta Empire","Mughal Empire","Chola Empire"],"choices_th":["จักรวรรดิมุริยา","จักรวรรดิกุปตา","จักรวรรดิมุกลาย","จักรวรรดิโชลา"],"answer":"Maurya Empire","answer_th":"จักรวรรดิมุริยา"},
  {"continent":"Asia","region":"Southeast Asia","difficulty":"medium","question":"Which Khmer temple complex in present-day Cambodia is the largest religious monument in the world?","question_th":"คอมเพล็กซ์วัดขอมรรนใดในกัมพูชาปัจจุบันเป็นอนุสาวรีย์ทางศาสนาที่ใหญ่ที่สุดในโลก?","choices":["Angkor Wat","Borobudur","Bagan","Ayutthaya"],"choices_th":["อังกอร์วัฒน์","โบโรบูดูร์","บาคัน","อยุธยา"],"answer":"Angkor Wat","answer_th":"อังกอร์วัฒน์"},
  {"continent":"Asia","region":"Central Asia","difficulty":"medium","question":"Which leader created a vast empire across Asia in the 13th century, known for his horse-mounted armies?","question_th":"ผู้นำใดสร้างจักรวรรดิขนาดใหญ่ทั่วเอเชียในศตวรรษที่ 13 เป็นที่รู้จักจากกองทัพม้า?","choices":["Genghis Khan","Tamerlane","Kublai Khan","Nader Shah"],"choices_th":["เจงกิสข่าน","ทามอร์แลน","คูบไลข่าน","นาเดอร์ชาห์"],"answer":"Genghis Khan","answer_th":"เจงกิสข่าน"},
  {"continent":"Asia","region":"East Asia","difficulty":"hard","question":"Which Japanese period (1185–1333) is marked by the dominance of samurai and the establishment of the first shogunate?","question_th":"ยุคญี่ปุ่นใด (ค.ศ. 1185-1333) มีลักษณะเด่นจากอำนาจของซามูไรและการสถาปนาโชกุนัตสึแรก?","choices":["Kamakura period","Heian period","Azuchi–Momoyama","Muromachi period"],"choices_th":["ยุคคามากูระ","ยุคเฮอัน","ยุคอาซูจิ-โมโมยามะ","ยุคมุโรมะจิ"],"answer":"Kamakura period","answer_th":"ยุคคามากูระ"},
  {"continent":"Asia","region":"South Asia","difficulty":"hard","question":"Which Persian origin dynasty established the Mughal Empire in India in the 16th century?","question_th":"ราชวงศ์เกิดจากเปอร์เซียใดที่สร้างจักรวรรดิมุกลายในอินเดียในศตวรรษที่ 16?","choices":["Babur's dynasty","Safavid","Ottoman","Maurya"],"choices_th":["ราชวงศ์บาบูร์","ราชวงศ์ซาฟาวี่","ราชวงศ์อัตโตมัน","ราชวงศ์มุริยา"],"answer":"Babur's dynasty","answer_th":"ราชวงศ์บาบูร์"},
  {"continent":"Europe","region":"Western Europe","difficulty":"easy","question":"Which event in 1066 led to Norman rule in England?","question_th":"เหตุการณ์ใดในค.ศ. 1066 นำมาซึ่งการปกครองของชาวนอร์แมนในอังกฤษ?","choices":["Battle of Hastings","Magna Carta","Great Fire of London","English Civil War"],"choices_th":["การประชุดเฮสติงส์","แมกนา คาร์ตา","ไฟไหม้ลอนดอนครั้งใหญ่","สงครามกลางเมืองอังกฤษ"],"answer":"Battle of Hastings","answer_th":"การประชุดเฮสติงส์"},
  {"continent":"Europe","region":"Eastern Europe","difficulty":"easy","question":"Which empire was ruled by tsars and ended after the 1917 revolution?","question_th":"จักรวรรดิใดที่ปกครองโดยซาร์และสิ้นสุดลงหลังจากการปฏิวัติปี ค.ศ. 1917?","choices":["Russian Empire","Ottoman Empire","Austro-Hungarian Empire","Byzantine Empire"],"choices_th":["จักรวรรดิรัสเซีย","จักรวรรดิอัตโตมัน","จักรวรรดิออสเตรีย-ฮังการี","จักรวรรดิไบแซนไทน์"],"answer":"Russian Empire","answer_th":"จักรวรรดิรัสเซีย"},
  {"continent":"Europe","region":"Southern Europe","difficulty":"medium","question":"Which ancient civilization famously built the Colosseum and aqueducts?","question_th":"อารยธรรมโบราณใดที่มีชื่อเสียงในการสร้างโคลอสเซียมและน้ำส่งน้ำ?","choices":["Roman Empire","Greek City-States","Etruscans","Byzantium"],"choices_th":["จักรวรรดิโรมัน","เมืองกรีก","อีตรุสคัน","ไบแซนไทม์"],"answer":"Roman Empire","answer_th":"จักรวรรดิโรมัน"},
  {"continent":"Europe","region":"Northern Europe","difficulty":"medium","question":"Which seafaring Norse people explored and settled Iceland, Greenland, and reached North America?","question_th":"ชาวไวกิงหรือชาวนอร์สใดที่เดินทางและตั้งถิ่นฐานในไอซ์แลนด์ กรีนแลนด์ และไปถึงอเมริกาเหนือ?","choices":["Vikings","Huns","Saxons","Franks"],"choices_th":["ไวกิง","ฮูน","แซกซัน","แฟรงก์"],"answer":"Vikings","answer_th":"ไวกิง"},
  {"continent":"Europe","region":"Western Europe","difficulty":"hard","question":"Which treaty signed in 1648 ended the Thirty Years' War and helped establish the modern state system in Europe?","question_th":"สนธิสัญญาใดที่ลงนามในค.ศ. 1648 สิ้นสุดสงครามสามสิบปีและช่วยสถาปนาระบบรัฐสมัยใหม่ในยุโรป?","choices":["Peace of Westphalia","Treaty of Versailles","Treaty of Utrecht","Treaty of Tordesillas"],"choices_th":["สัญญาสันติภาพเวสต์ฟาเลีย","สนธิสัญญาเวอร์ซายส์","สนธิสัญญาอูเทรคต์","สนธิสัญญาทอร์เดซิลลัส"],"answer":"Peace of Westphalia","answer_th":"สัญญาสันติภาพเวสต์ฟาเลีย"},
  {"continent":"Europe","region":"Eastern Europe","difficulty":"hard","question":"Which medieval empire preserved much of Roman law and Greek scholarship in its capital, Constantinople?","question_th":"จักรวรรดิยุคกลางใดที่อนุรักษ์กฎหมายโรมันและวรรณกรรมกรีกจำนวนมากในเมืองหลวง คอนสแตนติโนเปิล?","choices":["Byzantine Empire","Holy Roman Empire","Ottoman Empire","Kievan Rus'"],"choices_th":["จักรวรรดิไบแซนไทน์","จักรวรรดิโรมันศักดิ์สิทธิ์","จักรวรรดิอัตโตมัน","คีวัน รุสัญญ"],"answer":"Byzantine Empire","answer_th":"จักรวรรดิไบแซนไทน์"},
  {"continent":"North America","region":"Caribbean & Central America","difficulty":"easy","question":"Which civilization built the stepped pyramids at Chichén Itzá?","question_th":"อารยธรรมใดที่สร้างปิรามิดขั้นบันไดที่ชิชเช่น อิตซา?","choices":["Maya","Aztec","Inca","Olmec"],"choices_th":["มายา","แอซเทก","อินคา","โอลเมก"],"answer":"Maya","answer_th":"มายา"},
  {"continent":"North America","region":"Mesoamerica","difficulty":"easy","question":"Which empire had its capital at Tenochtitlán before Spanish conquest?","question_th":"จักรวรรดิใดที่มีเมืองหลวงอยู่ที่เทโนจตีตลัน ก่อนการพิชิตของสเปน?","choices":["Aztec","Maya","Inca","Toltec"],"choices_th":["แอซเทก","มายา","อินคา","โตลเทก"],"answer":"Aztec","answer_th":"แอซเทก"},
  {"continent":"North America","region":"United States","difficulty":"medium","question":"Which document, adopted in 1776, declared independence from Britain?","question_th":"เอกสารใดที่ยอมรับในค.ศ. 1776 ประกาศความเป็นอิสระจากอังกฤษ?","choices":["Declaration of Independence","Bill of Rights","Federalist Papers","Magna Carta"],"choices_th":["ปฏิญญาอิสรภาพ","บัญชีรายชื่อสิทธิ","เอกสารเฟดเดอรัลลิสต์","แมกนา คาร์ตา"],"answer":"Declaration of Independence","answer_th":"ปฏิญญาอิสรภาพ"},
  {"continent":"North America","region":"Canada","difficulty":"medium","question":"Which Indigenous polity in the Great Lakes region formed a confederacy known as the Iroquois or Haudenosaunee?","question_th":"รัฐบาลแพศ็อบในภูมิภาคทะเลสาบใหญ่ใดที่ประกอบเป็นสหพันธ์ที่รู้จักในนาม Iroquois หรือ Haudenosaunee?","choices":["The Iroquois Confederacy","The Aztec League","The Cherokee Nation","The Sioux Alliance"],"choices_th":["สหพันธ์ Iroquois","联盟แอซเทก","ประเทศเชโรกี","พันธมิตร Sioux"],"answer":"The Iroquois Confederacy","answer_th":"สหพันธ์ Iroquois"},
  {"continent":"North America","region":"United States","difficulty":"hard","question":"Which U.S. Supreme Court decision in 1857 denied citizenship to African Americans and inflamed sectional tensions?","question_th":"คำตัดสินศาลสูงสุดสหรัฐของค.ศ. 1857 ใดที่ปฏิเสธสิทธิพลเมืองแก่ชาวอเมริกันแอฟริกัน?","choices":["Dred Scott v. Sandford","Plessy v. Ferguson","Brown v. Board of Education","Marbury v. Madison"],"choices_th":["Dred Scott v. Sandford","Plessy v. Ferguson","Brown v. Board of Education","Marbury v. Madison"],"answer":"Dred Scott v. Sandford","answer_th":"Dred Scott v. Sandford"},
  {"continent":"North America","region":"Caribbean & Central America","difficulty":"hard","question":"Which 19th-century leader led independence movements across much of Spanish South America and had campaigns in the north (Bolivar)?","question_th":"ผู้นำศตวรรษที่ 19 ใดที่นำการเคลื่อนไหวเพื่ออิสรภาพในอเมริกาใต้สเปนส่วนใหญ่?","choices":["Simón Bolívar","José de San Martín","Miguel Hidalgo","Toussaint Louverture"],"choices_th":["ซิมง บอลิวาร์","โฮเซ่ เด ซัน มาร์ติน","มิเกล อิดัลโก","ตุสส็องเล้ เลเวเร"],"answer":"Simón Bolívar","answer_th":"ซิมง บอลิวาร์"},
  {"continent":"South America","region":"Andes","difficulty":"easy","question":"Which empire built Machu Picchu in the Andes?","question_th":"จักรวรรดิใดที่สร้างมาชูปิกชูในเทือกเขาแอนดีส?","choices":["Inca Empire","Muisca","Tiahuanaco","Chavín"],"choices_th":["จักรวรรดิอินคา","มุยสกา","เทียวานาโก","ชาวิน"],"answer":"Inca Empire","answer_th":"จักรวรรดิอินคา"},
  {"continent":"South America","region":"Amazon","difficulty":"easy","question":"Which European power colonized most of Brazil?","question_th":"อำนาจยุโรปใดที่ให้อาณานิคมแก่บราซิลส่วนใหญ่?","choices":["Portugal","Spain","France","Netherlands"],"choices_th":["โปรตุเกส","สเปน","ฝรั่งเศส","เนเธอร์แลนด์"],"answer":"Portugal","answer_th":"โปรตุเกส"},
  {"continent":"South America","region":"Southern Cone","difficulty":"medium","question":"Which 19th-century Argentine leader is associated with unifying the country and serving as its first president?","question_th":"ผู้นำอาร์เจนตินาศตวรรษที่ 19 ใดที่เกี่ยวข้องกับการรวมประเทศและเป็นประธานาธิบดีคนแรก?","choices":["Bartolomé Mitre","San Martín","Perón","Artigas"],"choices_th":["บาร์โตโลเมห์ มิเตร","ซัน มาร์ติน","เปรง","อาร์ติกัส"],"answer":"Bartolomé Mitre","answer_th":"บาร์โตโลเมห์ มิเตร"},
  {"continent":"South America","region":"Andes","difficulty":"medium","question":"Which leader led forces to independence in the southern part of South America (Argentina/Chile)?","question_th":"ผู้นำใดที่นำกองกำลังไปสู่อิสรภาพในส่วนใต้ของอเมริกาใต้ (อาร์เจนตินา/ชิลี)?","choices":["José de San Martín","Simón Bolívar","Antonio José de Sucre","Bernardo O'Higgins"],"choices_th":["โฮเซ่ เด ซัน มาร์ติน","ซิมง บอลิวาร์","อันโตนิโอ โฮเซ่ เด ซูเกร","เบอร์นาร์โด โอฮิกกินส์"],"answer":"José de San Martín","answer_th":"โฮเซ่ เด ซัน มาร์ติน"},
  {"continent":"South America","region":"Amazon","difficulty":"hard","question":"Which pre-Columbian culture in present-day Colombia was renowned for gold-working and the legend of El Dorado?","question_th":"วัฒนธรรมก่อนโคลัมบัสในโคลัมเบียปัจจุบันใดที่มีชื่อเสียงในด้านการทำงานทองคำและตำนานเอลโดราโด?","choices":["Muisca","Tiwanaku","Mapuche","Chibcha"],"choices_th":["มุยสกา","เทียวานาโก","มาปูเช","ชิบชา"],"answer":"Muisca","answer_th":"มุยสกา"},
  {"continent":"South America","region":"Southern Cone","difficulty":"hard","question":"Which 20th-century military dictatorship in Argentina was responsible for the 'Disappeared' during the Dirty War?","question_th":"ระบอบเผด็จการทหารศตวรรษที่ 20 ในอาร์เจนตินาใดที่รับผิดชอบการหายตัวไป ระหว่างสงครามสกปรก?","choices":["National Reorganization Process","Pinochet regime","Brazilian military government","Peruvian Sendero"],"choices_th":["กระบวนการปฏิรูปแห่งชาติ","ระบอบปิโนเชต์","รัฐบาลทหารบราซิล","เซนเดโร เปรู"],"answer":"National Reorganization Process","answer_th":"กระบวนการปฏิรูปแห่งชาติ"},
  {"continent":"Oceania","region":"Australia","difficulty":"easy","question":"Which people inhabited Australia for tens of thousands of years before European arrival?","question_th":"ชนชาติใดที่อาศัยอยู่ในออสเตรเลียนับพันปีมาแล้วก่อนการมาถึงของชาวยุโรป?","choices":["Aboriginal Australians","Maori","Samoans","Tongans"],"choices_th":["ชาวออสเตรเลียพื้นเมือง","มาโอรี","สามัว","โตงกา"],"answer":"Aboriginal Australians","answer_th":"ชาวออสเตรเลียพื้นเมือง"},
  {"continent":"Oceania","region":"Polynesia","difficulty":"easy","question":"Which navigators from Polynesia settled and named New Zealand Aotearoa?","question_th":"นักเดินเรือจากโพลิเนเซียใดที่ตั้งถิ่นฐานและตั้งชื่อนิวซีแลนด์ว่า Aotearoa?","choices":["Māori","Aboriginal Australians","Fijians","Samoans"],"choices_th":["มาโอรี","ชาวออสเตรเลียพื้นเมือง","ฟิจิ","สามัว"],"answer":"Māori","answer_th":"มาโอรี"},
  {"continent":"Oceania","region":"Australia","difficulty":"medium","question":"Which event in 1901 created the Commonwealth of Australia?","question_th":"เหตุการณ์ใดในค.ศ. 1901 สร้างเนชันแบ่ง Commonwealth ของออสเตรเลีย?","choices":["Federation of Australia","Australian Gold Rush","Eureka Rebellion","Anzac Landing"],"choices_th":["การรวมตัวของออสเตรเลีย","ค้นหาทองคำออสเตรเลีย","การจลาจลยูเรกา","การขึ้นจอดของ Anzac"],"answer":"Federation of Australia","answer_th":"การรวมตัวของออสเตรเลีย"},
  {"continent":"Oceania","region":"Melanesia","difficulty":"medium","question":"Which European explorer is credited with mapping parts of the Pacific including New Guinea in the 16th century?","question_th":"นักสำรวจชาวยุโรปใดที่ได้รับการยกย่องในการทำแผนที่บางส่วนของแปซิฟิกรวมถึงนิวกินีในศตวรรษที่ 16?","choices":["Alvaro de Saavedra","James Cook","Abel Tasman","Ferdinand Magellan"],"choices_th":["อัลวาโร เด ซาเวดรา","เจมส์ คุก","เอเบล ทัสมัน","เฟอร์ดินนนด์ แม่เจลแลน"],"answer":"Alvaro de Saavedra","answer_th":"อัลวาโร เด ซาเวดรา"},
  {"continent":"Oceania","region":"Polynesia","difficulty":"hard","question":"Which treaty in 1840 between some Māori chiefs and the British Crown is a foundational document for New Zealand?","question_th":"สนธิสัญญาค.ศ. 1840 ระหว่างหัวหน้ามาโอรีบางคนและมงกุฎอังกฤษใดที่เป็นเอกสารพื้นฐานสำหรับนิวซีแลนด์?","choices":["Treaty of Waitangi","Treaty of Tordesillas","Treaty of Versailles","Anglo-Maori Accord"],"choices_th":["สนธิสัญญาไว่ตังกี","สนธิสัญญาทอร์เดซิลลัส","สนธิสัญญาเวอร์ซายส์","สัญญาแองโกล-มาโอรี"],"answer":"Treaty of Waitangi","answer_th":"สนธิสัญญาไว่ตังกี"},
  {"continent":"Oceania","region":"Melanesia","difficulty":"hard","question":"Which World War II campaign in the Pacific involved heavy fighting in places like Guadalcanal?","question_th":"แคมเปญสงครามโลกครั้งที่สองในแปซิฟิกใดที่มีการสู้รบหนักในสถานที่เช่น Guadalcanal?","choices":["Guadalcanal Campaign","Battle of Midway","Battle of the Coral Sea","Leyte Gulf"],"choices_th":["แคมเปญกวาดัลคาแนล","การประชุด Midway","การประชุด Coral Sea","Gulf of Leyte"],"answer":"Guadalcanal Campaign","answer_th":"แคมเปญกวาดัลคาแนล"}
]

let currentLang = 'en'
let allQuestions = []
let quiz = { questions: [], current: 0, score: 0, answers: [] }
let timerInterval = null
const TIMER_DURATIONS = { easy: 20, medium: 15, hard: 10 }

function $(id){return document.getElementById(id)}

function t(key, vars = {}) {
  let text = translations[currentLang]?.[key] || translations.en[key] || key
  for (const [k, v] of Object.entries(vars)) {
    text = text.replace(`{${k}}`, v)
  }
  return text
}

function updateLanguage(lang) {
  currentLang = lang
  document.querySelectorAll('[data-i18n]').forEach(el => {
    const key = el.getAttribute('data-i18n')
    el.textContent = t(key)
  })
  document.querySelectorAll('[data-lang]').forEach(btn => {
    btn.classList.toggle('active', btn.getAttribute('data-lang') === lang)
  })
  if (quiz.questions.length > 0) {
    renderQuestion()
  }
}

function loadQuestions(){
  const master = QUIZ_DATA.slice()
  shuffle(master)
  allQuestions = master
}

function getSelectedContinents(){
  return Array.from(document.querySelectorAll('.checkboxes input[type=checkbox]:checked')).map(i=>i.value)
}

function getSelectedDifficulty(){
  const r = document.querySelector('input[name="difficulty"]:checked')
  return r ? r.value : 'easy'
}

function shuffle(arr){
  for(let i=arr.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));[arr[i],arr[j]]=[arr[j],arr[i]]
  }
}

function stopTimer(){
  if(timerInterval){
    clearInterval(timerInterval)
    timerInterval = null
  }
}

function startTimer(){
  stopTimer()
  const q = quiz.questions[quiz.current]
  let timeLeft = TIMER_DURATIONS[q.difficulty] || 10
  const timerEl = $('timer')
  
  timerEl.classList.remove('warning','danger')
  timerEl.textContent = timeLeft + 's'
  
  timerInterval = setInterval(()=>{
    timeLeft--
    if(timeLeft<=0){
      stopTimer()
      timerEl.textContent = '0s'
      timerEl.classList.add('danger')
      Array.from(document.querySelectorAll('.choice')).forEach(ch=>ch.onclick=null)
      $('nextBtn').disabled = false
      return
    }
    timerEl.textContent = timeLeft + 's'
    if(timeLeft<=5){
      timerEl.classList.add('warning')
    }
  },1000)
}

function startQuiz(){
  const continents = getSelectedContinents()
  const diff = getSelectedDifficulty()
  const num = parseInt($('numQuestions').value,10)
  const filtered = allQuestions.filter(q=>continents.includes(q.continent) && q.difficulty===diff)
  if(filtered.length===0){alert(t('noQuestionsMatch'));return}
  const initialCount = filtered.length
  if(initialCount < num){
    const remaining = num - initialCount
    const altPool = allQuestions.filter(q=>continents.includes(q.continent) && q.difficulty!==diff && !filtered.includes(q))
    shuffle(altPool)
    const toAdd = altPool.slice(0, Math.min(remaining, altPool.length))
    if(toAdd.length>0){
      filtered.push(...toAdd)
      alert(t('onlyMatched', {count: initialCount, difficulty: diff, added: toAdd.length, total: filtered.length}))
    } else {
      alert(t('proceedingWith', {count: initialCount}))
    }
  }
  shuffle(filtered)
  quiz.questions = filtered.slice(0,Math.min(num,filtered.length))
  quiz.current = 0
  quiz.score = 0
  quiz.answers = []
  $('controls').classList.add('hidden')
  $('results').classList.add('hidden')
  $('quiz').classList.remove('hidden')
  $('total').textContent = quiz.questions.length
  renderQuestion()
}

function renderQuestion(){
  const q = quiz.questions[quiz.current]
  const qText = currentLang === 'th' && q.question_th ? q.question_th : q.question
  const choices = currentLang === 'th' && q.choices_th ? q.choices_th : q.choices
  
  $('current').textContent = quiz.current+1
  $('questionText').textContent = `${qText} (${q.region} — ${q.continent})`
  const choicesDiv = $('choices')
  choicesDiv.innerHTML = ''
  const displayedChoices = choices.slice()
  shuffle(displayedChoices)
  for(const c of displayedChoices){
    const btn = document.createElement('div')
    btn.className = 'choice'
    btn.textContent = c
    btn.onclick = ()=>{
      const correctAns = currentLang === 'th' && q.answer_th ? q.answer_th : q.answer
      selectChoice(btn,c,correctAns)
    }
    choicesDiv.appendChild(btn)
  }
  $('nextBtn').disabled = true
  startTimer()
}

function selectChoice(elem,choice,correct){
  if($('nextBtn').disabled===false && quiz.current>=quiz.questions.length) return
  stopTimer()
  const children = Array.from(document.querySelectorAll('.choice'))
  children.forEach(ch=>ch.onclick=null)
  if(choice===correct){
    elem.classList.add('correct')
    quiz.score++
    quiz.answers.push({ok:true,choice,correct})
  } else {
    elem.classList.add('wrong')
    children.find(c=>c.textContent===correct)?.classList.add('correct')
    quiz.answers.push({ok:false,choice,correct})
  }
  $('nextBtn').disabled = false
}

function nextQuestion(){
  stopTimer()
  quiz.current++
  if(quiz.current>=quiz.questions.length){
    showResults()
  } else {
    renderQuestion()
  }
}

function showResults(){
  $('quiz').classList.add('hidden')
  $('results').classList.remove('hidden')
  const total = quiz.questions.length
  const correct = quiz.score
  const percent = Math.round((correct/total)*100)
  const breakdown = {}
  quiz.questions.forEach((q,i)=>{
    const cont = q.continent
    breakdown[cont] = breakdown[cont]||{total:0,correct:0}
    breakdown[cont].total++
    if(quiz.answers[i].ok) breakdown[cont].correct++
  })
  let html = `<p><strong>${t('score')}</strong> ${correct} / ${total} (${percent}%)</p>`
  html += `<h3>${t('byContinent')}</h3><ul>`
  for(const [c,v] of Object.entries(breakdown)){
    const p = Math.round((v.correct/v.total)*100)
    html += `<li>${c}: ${v.correct}/${v.total} (${p}%)</li>`
  }
  html += '</ul>'
  html += `<h3>${t('answers')}</h3><ol>`
  quiz.questions.forEach((q,i)=>{
    const a = quiz.answers[i]
    const qText = currentLang === 'th' && q.question_th ? q.question_th : q.question
    const correctAns = currentLang === 'th' && q.answer_th ? q.answer_th : q.answer
    const userClass = a && a.ok ? 'correct' : 'wrong'
    const userAnswer = a ? a.choice : 'No answer'
    html += `<li>${qText} — <strong>${a && a.ok? t('correct'):t('wrong')}</strong><br/>${t('yourAnswer')}: <span class="answer-user ${userClass}">${userAnswer}</span> · ${t('correctAnswer')}: <span class="answer-correct">${correctAns}</span></li>`
  })
  html += '</ol>'
  const missed = {}
  quiz.questions.forEach((q,i)=>{
    const a = quiz.answers[i]
    if(!a || a.ok) return
    const cont = q.continent || 'General'
    missed[cont] = missed[cont] || []
    const qText = currentLang === 'th' && q.question_th ? q.question_th : q.question
    missed[cont].push(qText)
  })

  html += `<h3>${t('studyRecommendations')}</h3>`
  if(Object.keys(missed).length === 0){
    html += `<p>${t('noWeakTopics')}</p>`
  } else {
    html += '<ul>'
    for(const [c, qs] of Object.entries(missed)){
      const examples = qs.slice(0,6).map(s=>s.replace(/\"/g,'')).join('; ')
      html += `<li><strong>${c}:</strong> ${examples}</li>`
    }
    html += '</ul>'
    html += `<p>${t('tip')}</p>`
  }

  $('summary').innerHTML = html
}

function restart(){
  $('controls').classList.add('hidden')
  $('results').classList.add('hidden')
}

window.addEventListener('DOMContentLoaded', ()=>{
  loadQuestions()
  
  document.querySelectorAll('[data-lang]').forEach(btn => {
    btn.addEventListener('click', () => {
      updateLanguage(btn.getAttribute('data-lang'))
    })
  })
  
  $('startBtn').addEventListener('click', ()=>{
    $('landing').classList.add('hidden')
    $('controls').classList.remove('hidden')
  })
  
  $('backBtn').addEventListener('click', ()=>{
    $('controls').classList.add('hidden')
    $('landing').classList.remove('hidden')
  })
  
  const startQuizBtn = $('startQuizBtn')
  if(startQuizBtn){
    startQuizBtn.addEventListener('click', ()=>{
      startQuiz()
    })
  }
  $('nextBtn').addEventListener('click', nextQuestion)
  $('restartBtn').addEventListener('click', ()=>{
    $('results').classList.add('hidden')
    $('landing').classList.remove('hidden')
  })
})
  </script>
</body>
</html>
